<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ethlo geodata server</title>

    <link rel="stylesheet"
          href="https://unpkg.com/purecss@1.0.0/build/pure-min.css"
          integrity="sha384-" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css?family=Abril+Fatface|Roboto:300,700" rel="stylesheet">

    <style>
        td.numeric {
            text-align: right;
        }

        th, td {
            padding: 10px;
            border-bottom: 1px solid #ccc;
        }

        html, body {
            background: #384650;
            color: #f5f5f5;
        }

        body {
            font-family: 'Roboto', sans-serif;
            font-weight: 300;
            margin: 5em;
            font-size: 1.1em;
            line-height: 2em;
            color: #f5f5f5;
        }

        h1, h2, h3, h4, h5, h6 {
            font-weight: 300;
        }

        .svg-container {
            position: relative;
            width: 3.5em;
            height: 1.3em;
            vertical-align: middle;
        }

        .data-table {
            margin-top: 1.5em;
        }

        .card {
            background: #4d606e;
            width: 20em;
            border: 1px solid #51697b;
            padding: 1.3em;
            box-shadow: 3px 3px 15px -4px #000000;
            margin-top: 2em;
            margin-left: auto;
            margin-right: auto;
        }

        .home-menu {
            padding: 0.5em;
            text-align: center;
            box-shadow: 0 1px 1px rgba(0, 0, 0, 0.10);
        }

        .home-menu {
            background: linear-gradient(0deg, rgba(20, 20, 20, 1) 0%, rgba(56, 70, 80, 1) 100%);
            padding-bottom: 0.8em
        }

        .pure-menu.pure-menu-fixed {
            border-bottom: 1px solid #333;
        }

        .home-menu .pure-menu-heading {
            color: white;
            font-weight: 300;
            font-size: 120%;
        }

        .home-menu .pure-menu-selected a {
            color: white;
        }

        h2 {
            margin-top: 2em;
        }

        th {
            font-weight: 300;
        }

        a, a:visited {
            color: #9fB5c6;
            text-decoration: none;
        }

        .home-menu a {
            color: #9fB5c6
        }

        .home-menu li a:hover,
        .home-menu li a:focus {
            background: none;
            border: none;
            color: #AECFE5;
        }

        /* We want to give the content area some more padding */
        .content {
            padding: 0.1em 1em 3em;
        }


        /* This is the class used for the footer */
        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
        }

        /*
         * -- TABLET (AND UP) MEDIA QUERIES --
         * On tablets and other medium-sized devices, we want to customize some
         * of the mobile styles.
         */
        @media (min-width: 48em) {

            /* We increase the body font size */
            body {
                font-size: 16px;
            }

            /* We can align the menu header to the left, but float the
            menu items to the right. */
            .home-menu {
                text-align: left;
            }

            .home-menu ul {
                float: right;
            }


            /* We remove the border-separator assigned to .l-box-lrg */
            .l-box-lrg {
                border: none;
            }
        }

        .main-stop {
            stop-color: #f5f5f5;
        }

        .alt-stop {
            stop-color: #f5f5f5 /* #fe7902 rgb(150 207 36)*/;
        }

    </style>

</head>
<body>

<div class="header">
    <div class="home-menu pure-menu pure-menu-horizontal pure-menu-fixed">
        <a class="pure-menu-heading" href="http://ethlo.com">
            <div class="svg-container">
                <svg viewBox="0 0 100 200">
                    <style type="text/css">
                        rect {
                            fill: url(#gradient)
                        }
                    </style>
                    <defs>
                        <linearGradient id="gradient">
                            <stop class="main-stop" offset="0%"/>
                            <stop class="alt-stop" offset="100%"/>
                        </linearGradient>
                    </defs>
                    <g>
                        <path fill="url(#gradient)"
                              d="m 20.64,35.28 c -1.84,3.04 -4.76,5 -9.24,5 C 5.36,40.28 1,35.8 1,29.96 1,24.16 5.4,19.68 11.24,19.68 c 5.96,0 10.12,4.56 10.12,9.68 0,0.64 -0.04,1.08 -0.08,1.32 H 3.08 c 0.32,4.88 4,7.68 8.32,7.68 3.96,0 6.16,-1.56 7.72,-4.12 z m -9.4,-13.72 c -4.08,0 -7.68,2.84 -8.16,7.32 h 16.24 c -0.4,-4.52 -3.96,-7.32 -8.08,-7.32 z M 28.08,20 h 5.56 v 1.76 h -5.56 v 12.16 c 0,3.36 2.2,4.2 4,4.2 H 33.6 V 40 h -1.56 c -2.72,0 -5.88,-1.52 -5.88,-6.08 V 21.76 h -3 V 20 h 3 v -5.8 h 1.92 z M 38.2,12.6 v 10.44 c 1.16,-1.8 3.2,-3.36 6.68,-3.36 4.68,0 7.76,3.16 7.76,8.08 V 40 H 50.68 V 28 c 0,-4.04 -2.24,-6.44 -6,-6.44 -3.92,0 -6.48,2.64 -6.48,7 V 40 H 36.24 V 12.6 Z M 57.8,40 H 55.84 V 12.6 H 57.8 Z M 70.72,19.68 c 5.8,0 10.28,4.48 10.28,10.28 0,5.84 -4.48,10.32 -10.28,10.32 -5.84,0 -10.32,-4.48 -10.32,-10.32 0,-5.8 4.48,-10.28 10.32,-10.28 z m 0,1.88 c -4.8,0 -8.36,3.68 -8.36,8.44 0,4.72 3.56,8.4 8.36,8.4 4.76,0 8.32,-3.68 8.32,-8.4 0,-4.76 -3.56,-8.44 -8.32,-8.44 z"/>
                    </g>
                </svg>
            </div>
        </a>

        <ul class="pure-menu-list">
            <li class="pure-menu-item"><a href="#" class="pure-menu-link">Home</a></li>
            <li class="pure-menu-item"><a href="/swagger-ui/?url=/spec.yaml"
                                          class="pure-menu-link">API documentation</a></li>
            <li class="pure-menu-item"><a
                    href="https://github.com/ethlo/geodata" class="pure-menu-link">GitHub</a></li>
        </ul>
    </div>
</div>

<div class="content-wrapper">
    <div class="content">
        <h2>Simple, fast and free geodata server for flexible deployment</h2>
        <p>
            Quick startup, low memory overhead and super-low response times.
        </p>

        <h2>Source data</h2>
        <p>This service utilize data from:</p>
        <ul>
            <li><a href="https://geonames.org">Geonames.org</a> - Free data is available under CC 2.0 license</li>
            <li>This product includes GeoLite2 data created by MaxMind, available from
                <a href="https://www.maxmind.com">https://www.maxmind.com</a>.
            </li>
        </ul>

        <div id="source-data">
            <table class="data-table" style="width: 100%">
                <thead>
                <tr>
                    <th style="text-align:left">Source</th>
                    <th style="text-align: right">Count</th>
                    <th>Last updated</th>
                </tr>
                </thead>
                <tr>
                    <td>MaxMind GeoLite2 data</td>
                    <td class="numeric" data-count="ip"></td>
                    <td style="text-align: center">
                        <span data-lastmodified="ip"></span>
                        -
                        <time data-lastmodified="ip" class="timeago"></time>
                    </td>
                </tr>
                <tr>
                    <td>Geonames.org data</td>
                    <td class="numeric" data-count="locations"></td>
                    <td style="text-align: center">
                        <span data-lastmodified="locations"></span>
                        -
                        <time data-lastmodified="locations" class="timeago"></time>
                    </td>
                </tr>
            </table>
        </div>

        <h2>Disclaimer</h2>
        <p>
            THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED
            WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
            PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY
            DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
            PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
            HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
            NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
            POSSIBILITY OF SUCH DAMAGE.
        </p>
    </div>
</div>

<script>
    const numberWithCommas = (x) => {
        var parts = x.toString().split(".");
        parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        return parts.join(".");
    }

    var xhr = new XMLHttpRequest();
    xhr.open('GET', '/v1/source');
    xhr.onload = function () {

        var ele = document.getElementById('source-data');

        if (xhr.status === 200) {
            var array = JSON.parse(xhr.responseText).data;
            array.forEach(function (o) {
                console.log(o);
                var name = o.type.toLowerCase();
                var ele = document.querySelector('td[data-count="' + name + '"]');
                if (ele) ele.innerHTML = numberWithCommas(o.count);

                ele = document.querySelector('span[data-lastmodified="' + name + '"]');
                if (ele) ele.innerHTML = new Date(o.lastModified).toLocaleString();

                ele = document.querySelector('time[data-lastmodified="' + name + '"]');
                if (ele) $(ele).attr('datetime', o.lastModified);
            });

            jQuery(document).ready(function () {
                $("time.timeago").timeago();
            });
        } else {
            ele.innerHTML = '<p>Unable to load source data information</p>';
        }
    };
    xhr.send();

</script>

<script
        src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous"></script>
<script
        src="https://cdnjs.cloudflare.com/ajax/libs/jquery-timeago/1.6.1/jquery.timeago.min.js"
        integrity="sha256-JAdlnMiYFZRwqQqgiYwLjSkV94QtVzcbvasQMm05THk="
        crossorigin="anonymous"></script>

</body>
</html>
